const CACHE_NAME="story-map-v2",BASE_PATH="/submitan-pertama-Intermediate",CACHE_ASSETS=[`${BASE_PATH}/`,`${BASE_PATH}/index.html`,`${BASE_PATH}/app.bundle.js`,`${BASE_PATH}/app.css`,`${BASE_PATH}/images/logo.png`,`${BASE_PATH}/favicon.png`,`${BASE_PATH}/offline.html`];self.addEventListener("install",(e=>{e.waitUntil(caches.open(CACHE_NAME).then((e=>(console.log("Caching assets"),e.addAll(CACHE_ASSETS)))).then((()=>self.skipWaiting())))})),self.addEventListener("activate",(e=>{e.waitUntil(caches.keys().then((e=>Promise.all(e.map((e=>{if(e!==CACHE_NAME)return console.log("Clearing old cache"),caches.delete(e)}))))).then((()=>self.clients.claim())))})),self.addEventListener("fetch",(e=>{const{request:t}=e;new URL(t.url).origin===self.location.origin&&("navigate"!==t.mode?e.respondWith(caches.match(t).then((e=>e&&!t.url.includes("/v1/")?e:t.url.includes("/v1/")?fetch(t).catch((()=>e||new Response(JSON.stringify({error:"Offline"}),{status:503,headers:{"Content-Type":"application/json"}}))):fetch(t).then((e=>{if(!e||200!==e.status||"basic"!==e.type)return e;const n=e.clone();return"GET"===t.method&&caches.open(CACHE_NAME).then((e=>{e.put(t,n)})),e})).catch((()=>e||("image"===t.destination?new Response("",{status:404}):e)))))):e.respondWith(fetch(t).then((e=>{const n=e.clone();return caches.open(CACHE_NAME).then((e=>{e.put(t,n)})),e})).catch((()=>caches.match(t).then((e=>e||caches.match(`${BASE_PATH}/offline.html`)||caches.match("/offline.html")))))))})),self.addEventListener("push",(e=>{if(!e.data)return;const t=e.data.json(),n=t.title||"New Update",i={body:t.message||"There is a new update available!",icon:`${BASE_PATH}/images/logo.png`,badge:`${BASE_PATH}/images/logo.png`,data:{url:t.url||`${BASE_PATH}/`},actions:[{action:"view-details",title:"View Details"},{action:"dismiss",title:"Dismiss"}]};e.waitUntil(self.registration.showNotification(n,i))})),self.addEventListener("notificationclick",(e=>{e.notification.close(),"view-details"===e.action&&e.notification.data.url?e.waitUntil(clients.openWindow(e.notification.data.url)):"dismiss"===e.action||e.notification.data&&e.notification.data.url&&e.waitUntil(clients.openWindow(e.notification.data.url))})),self.addEventListener("sync",(e=>{"sync-stories"===e.tag&&e.waitUntil(self.clients.matchAll().then((e=>Promise.all(e.map((e=>e.postMessage({type:"SYNC_STORIES"})))))))})),self.addEventListener("message",(e=>{e.data&&"TRIGGER_SYNC"===e.data.type&&e.waitUntil(self.clients.matchAll().then((e=>{e.forEach((e=>{e.postMessage({type:"SYNC_STORIES"})}))})))}));