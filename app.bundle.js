/*! For license information please see app.bundle.js.LICENSE.txt */
(()=>{"use strict";var t,e={17:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function i(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?o(Object(r),!0).forEach((function(e){a(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):o(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function a(t,e,r){return(e=f(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function c(){c=function(){return e};var t,e={},r=Object.prototype,o=r.hasOwnProperty,i=Object.defineProperty||function(t,e,r){t[e]=r.value},a="function"==typeof Symbol?Symbol:{},s=a.iterator||"@@iterator",u=a.asyncIterator||"@@asyncIterator",l=a.toStringTag||"@@toStringTag";function f(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{f({},"")}catch(t){f=function(t,e,r){return t[e]=r}}function h(t,e,r,n){var o=e&&e.prototype instanceof b?e:b,a=Object.create(o.prototype),c=new I(n||[]);return i(a,"_invoke",{value:P(t,r,c)}),a}function p(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=h;var d="suspendedStart",v="suspendedYield",y="executing",g="completed",m={};function b(){}function w(){}function x(){}var k={};f(k,s,(function(){return this}));var E=Object.getPrototypeOf,S=E&&E(E(A([])));S&&S!==r&&o.call(S,s)&&(k=S);var L=x.prototype=b.prototype=Object.create(k);function O(t){["next","throw","return"].forEach((function(e){f(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(i,a,c,s){var u=p(t[i],t,a);if("throw"!==u.type){var l=u.arg,f=l.value;return f&&"object"==n(f)&&o.call(f,"__await")?e.resolve(f.__await).then((function(t){r("next",t,c,s)}),(function(t){r("throw",t,c,s)})):e.resolve(f).then((function(t){l.value=t,c(l)}),(function(t){return r("throw",t,c,s)}))}s(u.arg)}var a;i(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return a=a?a.then(o,o):o()}})}function P(e,r,n){var o=d;return function(i,a){if(o===y)throw Error("Generator is already running");if(o===g){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=_(c,n);if(s){if(s===m)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===d)throw o=g,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=y;var u=p(e,r,n);if("normal"===u.type){if(o=n.done?g:v,u.arg===m)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=g,n.method="throw",n.arg=u.arg)}}}function _(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),m;var i=p(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,m;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,m):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,m)}function N(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(N,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[s];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var i=-1,a=function r(){for(;++i<e.length;)if(o.call(e,i))return r.value=e[i],r.done=!1,r;return r.value=t,r.done=!0,r};return a.next=a}}throw new TypeError(n(e)+" is not iterable")}return w.prototype=x,i(L,"constructor",{value:x,configurable:!0}),i(x,"constructor",{value:w,configurable:!0}),w.displayName=f(x,l,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,f(t,l,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},O(j.prototype),f(j.prototype,u,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new j(h(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(L),f(L,l,"Generator"),f(L,s,(function(){return this})),f(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&o.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function n(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return n("end");if(a.tryLoc<=this.prev){var s=o.call(a,"catchLoc"),u=o.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return n(a.catchLoc,!0);if(this.prev<a.finallyLoc)return n(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return n(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return n(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var n=this.tryEntries[r];if(n.tryLoc<=this.prev&&o.call(n,"finallyLoc")&&this.prev<n.finallyLoc){var i=n;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,m):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),m},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),m}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),m}},e}function s(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function u(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){s(i,n,o,a,c,"next",t)}function c(t){s(i,n,o,a,c,"throw",t)}a(void 0)}))}}function l(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,f(n.key),n)}}function f(t){var e=function(t){if("object"!=n(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==n(e)?e:e+""}r.r(e),r.d(e,{default:()=>h});const h=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"requestPermission",value:(d=u(c().mark((function t(){var e;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if("Notification"in window){t.next=3;break}return console.log("This browser does not support notifications"),t.abrupt("return",!1);case 3:if("granted"!==Notification.permission){t.next=5;break}return t.abrupt("return",!0);case 5:return t.next=7,Notification.requestPermission();case 7:return e=t.sent,t.abrupt("return","granted"===e);case 9:case"end":return t.stop()}}),t)}))),function(){return d.apply(this,arguments)})},{key:"isPushSupported",value:(p=u(c().mark((function t(){return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return","serviceWorker"in navigator&&"PushManager"in window);case 1:case"end":return t.stop()}}),t)}))),function(){return p.apply(this,arguments)})},{key:"getSubscription",value:(h=u(c().mark((function t(){var e,r,n;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,navigator.serviceWorker.ready;case 3:return e=t.sent,t.next=6,e.pushManager.getSubscription();case 6:return(r=t.sent)?localStorage.setItem("pushSubscription",JSON.stringify(r)):localStorage.removeItem("pushSubscription"),t.abrupt("return",r);case 11:return t.prev=11,t.t0=t.catch(0),console.error("Error getting subscription:",t.t0),n=localStorage.getItem("pushSubscription"),t.abrupt("return",n?JSON.parse(n):null);case 16:case"end":return t.stop()}}),t,null,[[0,11]])}))),function(){return h.apply(this,arguments)})},{key:"subscribeUser",value:(f=u(c().mark((function t(e){var r,n,o;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e){t.next=3;break}throw new Error("VAPID public key is required");case 3:return t.next=5,navigator.serviceWorker.ready;case 5:return r=t.sent,t.next=8,r.pushManager.getSubscription();case 8:if(!(n=t.sent)){t.next=12;break}return localStorage.setItem("pushSubscription",JSON.stringify(n)),t.abrupt("return",n);case 12:return o=this.urlBase64ToUint8Array(e),t.next=15,r.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:o});case 15:return(n=t.sent)&&localStorage.setItem("pushSubscription",JSON.stringify(n)),t.abrupt("return",n);case 20:throw t.prev=20,t.t0=t.catch(0),console.error("Error subscribing user:",t.t0),t.t0;case 24:case"end":return t.stop()}}),t,this,[[0,20]])}))),function(t){return f.apply(this,arguments)})},{key:"unsubscribeUser",value:(s=u(c().mark((function t(){var e,r,n,o=arguments;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e=o.length>0&&void 0!==o[0]?o[0]:null,t.prev=1,t.next=4,navigator.serviceWorker.ready;case 4:return r=t.sent,t.next=7,r.pushManager.getSubscription();case 7:if(!(n=t.sent)){t.next=26;break}if(!e){t.next=20;break}return t.prev=10,t.next=13,fetch("https://story-api.dicoding.dev/v1/notifications/unsubscribe",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(e)},body:JSON.stringify(n)});case 13:t.sent.ok||console.warn("Server unsubscribe failed, but continuing with local unsubscribe"),t.next=20;break;case 17:t.prev=17,t.t0=t.catch(10),console.error("Error unsubscribing from server:",t.t0);case 20:return t.next=22,n.unsubscribe();case 22:if(!t.sent){t.next=26;break}return localStorage.removeItem("pushSubscription"),t.abrupt("return",!0);case 26:return localStorage.removeItem("pushSubscription"),t.abrupt("return",!1);case 30:return t.prev=30,t.t1=t.catch(1),console.error("Error unsubscribing user:",t.t1),localStorage.removeItem("pushSubscription"),t.abrupt("return",!1);case 35:case"end":return t.stop()}}),t,null,[[1,30],[10,17]])}))),function(){return s.apply(this,arguments)})},{key:"sendSubscriptionToServer",value:(a=u(c().mark((function t(e,r){var n,o;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e){t.next=3;break}throw new Error("Subscription is required");case 3:if(r){t.next=7;break}return console.warn("No token provided, subscription will be stored locally only"),localStorage.setItem("pushSubscription",JSON.stringify(e)),t.abrupt("return",!1);case 7:return t.next=9,fetch("https://story-api.dicoding.dev/v1/notifications/subscribe",{method:"POST",headers:{"Content-Type":"application/json",Authorization:"Bearer ".concat(r)},body:JSON.stringify(e)});case 9:if((n=t.sent).ok){t.next=15;break}return t.next=13,n.text();case 13:throw o=t.sent,new Error("Failed to send subscription to server: ".concat(n.status," ").concat(o));case 15:return localStorage.setItem("pushSubscription",JSON.stringify(e)),t.abrupt("return",!0);case 19:return t.prev=19,t.t0=t.catch(0),console.error("Error sending subscription:",t.t0),e&&localStorage.setItem("pushSubscription",JSON.stringify(e)),t.abrupt("return",!1);case 24:case"end":return t.stop()}}),t,null,[[0,19]])}))),function(t,e){return a.apply(this,arguments)})},{key:"urlBase64ToUint8Array",value:function(t){for(var e=(t+"=".repeat((4-t.length%4)%4)).replace(/\-/g,"+").replace(/_/g,"/"),r=window.atob(e),n=new Uint8Array(r.length),o=0;o<r.length;++o)n[o]=r.charCodeAt(o);return n}},{key:"showLocalNotification",value:(o=u(c().mark((function t(e){var r,n,o,a,s,u,l,f,h,p,d=arguments;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=d.length>1&&void 0!==d[1]?d[1]:{},"Notification"in window){t.next=4;break}return console.log("This browser does not support notifications"),t.abrupt("return",!1);case 4:if(t.prev=4,"serviceWorker"in navigator){t.next=8;break}return console.log("Service Worker not supported"),t.abrupt("return",!1);case 8:return t.next=10,navigator.serviceWorker.ready;case 10:if(n=t.sent,"granted"!==Notification.permission){t.next=21;break}return o="localhost"!==window.location.hostname&&"127.0.0.1"!==window.location.hostname,a=o?"/submitan-pertama-Intermediate":"",s=r.icon||"".concat(a,"/images/logo.png").replace(/\/+/g,"/"),u=r.badge||"".concat(a,"/images/logo.png").replace(/\/+/g,"/"),t.next=18,n.showNotification(e,i({body:r.body||"",icon:s,badge:u,tag:r.tag||"local-notification",requireInteraction:r.requireInteraction||!1},r));case 18:case 32:return t.abrupt("return",!0);case 21:if("denied"===Notification.permission){t.next=33;break}return t.next=24,Notification.requestPermission();case 24:if("granted"!==t.sent){t.next=33;break}return l="localhost"!==window.location.hostname&&"127.0.0.1"!==window.location.hostname,f=l?"/submitan-pertama-Intermediate":"",h=r.icon||"".concat(f,"/images/logo.png").replace(/\/+/g,"/"),p=r.badge||"".concat(f,"/images/logo.png").replace(/\/+/g,"/"),t.next=32,n.showNotification(e,i({body:r.body||"",icon:h,badge:p,tag:r.tag||"local-notification",requireInteraction:r.requireInteraction||!1},r));case 33:return t.abrupt("return",!1);case 36:return t.prev=36,t.t0=t.catch(4),console.error("Error showing local notification:",t.t0),t.abrupt("return",!1);case 40:case"end":return t.stop()}}),t,null,[[4,36]])}))),function(t){return o.apply(this,arguments)})},{key:"testNotification",value:(n=u(c().mark((function t(){var e,r;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e="localhost"!==window.location.hostname&&"127.0.0.1"!==window.location.hostname,r="".concat(e?"/submitan-pertama-Intermediate":"","/images/logo.png").replace(/\/+/g,"/"),t.next=5,this.showLocalNotification("Test Notifikasi",{body:"Ini adalah notifikasi test. Jika Anda melihat ini, notifikasi berfungsi dengan baik!",tag:"test-notification",icon:r,badge:r});case 5:return t.abrupt("return",t.sent);case 6:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"initialize",value:(r=u(c().mark((function t(){var e;return c().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,"Notification"in window&&"serviceWorker"in navigator){t.next=4;break}return console.log("Notifications not supported"),t.abrupt("return",!1);case 4:if(localStorage.getItem("notificationPermissionRequested")||"default"!==Notification.permission){t.next=14;break}return t.next=8,this.requestPermission();case 8:if(e=t.sent,localStorage.setItem("notificationPermissionRequested","true"),!e){t.next=13;break}return t.next=13,this.showLocalNotification("Notifikasi Diaktifkan",{body:"Anda akan menerima notifikasi dari Story Map.",tag:"notification-enabled",icon:"/images/logo.png",badge:"/images/logo.png"});case 13:return t.abrupt("return",e);case 14:return t.abrupt("return","granted"===Notification.permission);case 17:return t.prev=17,t.t0=t.catch(0),console.error("Error initializing notifications:",t.t0),t.abrupt("return",!1);case 21:case"end":return t.stop()}}),t,this,[[0,17]])}))),function(){return r.apply(this,arguments)})}],e&&l(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,a,s,f,h,p,d}()},156:(t,e,r)=>{r.d(e,{A:()=>c});var n=r(354),o=r.n(n),i=r(314),a=r.n(i)()(o());a.push([t.id,"// extracted by mini-css-extract-plugin\nexport {};","",{version:3,sources:["webpack://./src/styles/styles.css"],names:[],mappings:"AAAA;QACS,CAAA",sourcesContent:["// extracted by mini-css-extract-plugin\nexport {};"],sourceRoot:""}]);const c=a},420:(t,e,r)=>{var n=r(72),o=r.n(n),i=r(284),a=r.n(i),c=r(659),s=r.n(c),u=r(56),l=r.n(u),f=r(540),h=r.n(f),p=r(156),d={};d.setAttributes=l(),d.insert=s().bind(null,"head"),d.domAPI=a(),d.insertStyleElement=h(),o()(p.A,d),p.A&&p.A.locals&&p.A.locals;function v(t){return v="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},v(t)}function y(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function g(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?y(Object(r),!0).forEach((function(e){m(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):y(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function m(t,e,r){return(e=E(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function b(){b=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof m?e:m,a=Object.create(i.prototype),c=new I(n||[]);return o(a,"_invoke",{value:P(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",y="completed",g={};function m(){}function w(){}function x(){}var k={};u(k,a,(function(){return this}));var E=Object.getPrototypeOf,S=E&&E(E(A([])));S&&S!==r&&n.call(S,a)&&(k=S);var L=x.prototype=m.prototype=Object.create(k);function O(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function j(t,e){function r(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==v(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function P(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===y){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=_(c,n);if(s){if(s===g)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=y,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?y:p,u.arg===g)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=y,n.method="throw",n.arg=u.arg)}}}function _(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,_(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),g;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,g;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,g):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,g)}function N(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(N,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(v(e)+" is not iterable")}return w.prototype=x,o(L,"constructor",{value:x,configurable:!0}),o(x,"constructor",{value:w,configurable:!0}),w.displayName=u(x,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===w||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,x):(t.__proto__=x,u(t,s,"GeneratorFunction")),t.prototype=Object.create(L),t},e.awrap=function(t){return{__await:t}},O(j.prototype),u(j.prototype,c,(function(){return this})),e.AsyncIterator=j,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new j(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},O(L),u(L,s,"Generator"),u(L,a,(function(){return this})),u(L,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,g):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),g},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),g}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),g}},e}function w(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function x(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){w(i,n,o,a,c,"next",t)}function c(t){w(i,n,o,a,c,"throw",t)}a(void 0)}))}}function k(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,E(n.key),n)}}function E(t){var e=function(t){if("object"!=v(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=v(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==v(e)?e:e+""}var S=new(function(){return t=function t(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:"StoryMapDB",r=arguments.length>1&&void 0!==arguments[1]?arguments[1]:1;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),this.dbName=e,this.version=r,this.db=null},e=[{key:"openDatabase",value:(l=x(b().mark((function t(){var e=this;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!this.db){t.next=2;break}return t.abrupt("return",this.db);case 2:return t.abrupt("return",new Promise((function(t,r){var n=indexedDB.open(e.dbName,e.version);n.onupgradeneeded=function(t){var e=t.target.result;e.objectStoreNames.contains("stories")||e.createObjectStore("stories",{keyPath:"id"}).createIndex("timestamp","createdAt",{unique:!1}),e.objectStoreNames.contains("syncQueue")||e.createObjectStore("syncQueue",{keyPath:"id",autoIncrement:!0}).createIndex("type","type",{unique:!1})},n.onsuccess=function(r){e.db=r.target.result,t(e.db)},n.onerror=function(t){console.error("Error opening IndexedDB:",t.target.error),r(t.target.error)}})));case 3:case"end":return t.stop()}}),t,this)}))),function(){return l.apply(this,arguments)})},{key:"addStory",value:(u=x(b().mark((function t(e){var r,n=this;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.openDatabase();case 2:return r=t.sent,t.abrupt("return",new Promise((function(t,o){var i=r.transaction(["stories"],"readwrite").objectStore("stories"),a=g(g({},e),{},{id:e.id||"local-".concat(Date.now(),"-").concat(Math.random().toString(36).substring(2,11)),isLocal:!e.id,createdAt:e.createdAt||(new Date).toISOString(),updatedAt:(new Date).toISOString()}),c=i.put(a);c.onsuccess=function(){console.log("Story saved successfully:",a.id),t(g(g({},a),{},{id:c.result||a.id}))},c.onerror=function(r){console.error("Error saving story:",r.target.error),"ConstraintError"===r.target.error.name?(console.warn("Duplicate ID detected, retrying with new ID..."),e.id="local-".concat(Date.now(),"-").concat(Math.random().toString(36).substring(2,11)),n.addStory(e).then(t).catch(o)):o(r.target.error)}})));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return u.apply(this,arguments)})},{key:"getStories",value:(s=x(b().mark((function t(){var e;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.openDatabase();case 2:return e=t.sent,t.abrupt("return",new Promise((function(t,r){var n=e.transaction(["stories"],"readonly").objectStore("stories").index("timestamp").getAll();n.onsuccess=function(){return t(n.result)},n.onerror=function(t){console.error("Error getting stories:",t.target.error),r(t.target.error)}})));case 4:case"end":return t.stop()}}),t,this)}))),function(){return s.apply(this,arguments)})},{key:"getStory",value:(c=x(b().mark((function t(e){var r;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.openDatabase();case 2:return r=t.sent,t.abrupt("return",new Promise((function(t,n){var o=r.transaction(["stories"],"readonly").objectStore("stories").get(e);o.onsuccess=function(){return t(o.result)},o.onerror=function(t){console.error("Error getting story:",t.target.error),n(t.target.error)}})));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return c.apply(this,arguments)})},{key:"updateStory",value:(a=x(b().mark((function t(e){var r;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.openDatabase();case 2:return r=t.sent,t.abrupt("return",new Promise((function(t,n){var o=r.transaction(["stories"],"readwrite").objectStore("stories"),i=g(g({},e),{},{updatedAt:(new Date).toISOString()}),a=o.put(i);a.onsuccess=function(){return t(a.result)},a.onerror=function(t){console.error("Error updating story:",t.target.error),n(t.target.error)}})));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return a.apply(this,arguments)})},{key:"deleteStory",value:(i=x(b().mark((function t(e){var r;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.openDatabase();case 2:return r=t.sent,t.abrupt("return",new Promise((function(t,n){var o=r.transaction(["stories"],"readwrite").objectStore("stories").delete(e);o.onsuccess=function(){return t(!0)},o.onerror=function(t){console.error("Error deleting story:",t.target.error),n(t.target.error)}})));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return i.apply(this,arguments)})},{key:"addToSyncQueue",value:(o=x(b().mark((function t(e){var r,n=this;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,this.openDatabase();case 2:return r=t.sent,t.abrupt("return",new Promise((function(t,o){var i=r.transaction(["syncQueue"],"readwrite").objectStore("syncQueue").add(g(g({},e),{},{status:"pending",createdAt:(new Date).toISOString()}));i.onsuccess=function(){navigator.onLine&&n.processSyncQueue(),t(i.result)},i.onerror=function(t){console.error("Error adding to sync queue:",t.target.error),o(t.target.error)}})));case 4:case"end":return t.stop()}}),t,this)}))),function(t){return o.apply(this,arguments)})},{key:"processSyncQueue",value:(n=x(b().mark((function t(){var e,r=this;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(navigator.onLine){t.next=2;break}return t.abrupt("return");case 2:return t.next=4,this.openDatabase();case 4:return e=t.sent,t.abrupt("return",new Promise((function(t,n){var o=e.transaction(["syncQueue"],"readwrite").objectStore("syncQueue").index("type").openCursor(IDBKeyRange.only("sync-stories")),i=[];o.onsuccess=function(o){var a=o.target.result;if(a){var c=a.value,s=a.primaryKey;if("pending"===c.status||!c.status){var u=r.syncWithServer(c).then((function(){return new Promise((function(t){var r=e.transaction(["syncQueue"],"readwrite").objectStore("syncQueue").delete(s);r.onsuccess=function(){console.log("Synced and removed from queue:",s),t()},r.onerror=function(){console.error("Error deleting synced item"),t()}}))})).catch((function(t){return console.error("Sync failed:",t),new Promise((function(r){var n=e.transaction(["syncQueue"],"readwrite").objectStore("syncQueue"),o=g({},c);if(o.status="failed",o.retryCount=(o.retryCount||0)+1,o.lastError=t.message,o.updatedAt=(new Date).toISOString(),o.retryCount<5){var i=n.put(o);i.onsuccess=function(){return r()},i.onerror=function(){return r()}}else{var a=n.delete(s);a.onsuccess=function(){console.log("Removed item after too many failures:",s),r()},a.onerror=function(){return r()}}}))}));i.push(u)}a.continue()}else i.length>0?Promise.all(i).then((function(){console.log("Sync queue processing completed"),t()})).catch(n):t()},o.onerror=function(t){console.error("Error processing sync queue:",t.target.error),n(t.target.error)}})));case 6:case"end":return t.stop()}}),t,this)}))),function(){return n.apply(this,arguments)})},{key:"syncWithServer",value:(r=x(b().mark((function t(e){var r,n,o,i,a,c,s,u,l,f,h,p;return b().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=e.method,n=e.url,o=e.headers,i=e.data,a=e.meta,t.prev=1,"POST"!==r||!n.includes("/stories")){t.next=41;break}if((c=new FormData).append("description",i.description),!i.photo){t.next=19;break}if(!(i.photo instanceof File)){t.next=10;break}c.append("photo",i.photo),t.next=19;break;case 10:if(!(a&&a.photoName&&a.photoType)){t.next=18;break}if(!a.localId){t.next=16;break}return t.next=14,this.getStory(a.localId);case 14:(s=t.sent)&&s.photo&&s.photo.blob?(u=new Blob([s.photo.blob],{type:a.photoType}),l=new File([u],a.photoName,{type:a.photoType}),c.append("photo",l)):console.warn("Photo not found in local story, skipping photo sync");case 16:t.next=19;break;case 18:console.warn("Photo sync skipped - file not available");case 19:return i.lat&&i.lon&&(c.append("lat",i.lat.toString()),c.append("lon",i.lon.toString())),t.next=22,fetch(n,{method:"POST",headers:{Authorization:o.Authorization},body:c});case 22:if((f=t.sent).ok){t.next=28;break}return t.next=26,f.json();case 26:throw h=t.sent,new Error(h.message||"Failed to sync story");case 28:return t.next=30,f.json();case 30:if(p=t.sent,!(a&&a.localId&&p.story)){t.next=40;break}return t.next=34,this.getStory(a.localId);case 34:if(!t.sent){t.next=40;break}return t.next=38,this.updateStory(g(g({},p.story),{},{id:p.story.id,isLocal:!1}));case 38:return t.next=40,this.deleteStory(a.localId);case 40:return t.abrupt("return",p);case 41:return t.abrupt("return",Promise.resolve());case 44:throw t.prev=44,t.t0=t.catch(1),console.error("Sync error:",t.t0),t.t0;case 48:case"end":return t.stop()}}),t,this,[[1,44]])}))),function(t){return r.apply(this,arguments)})},{key:"setupSyncListeners",value:function(){var t=this;"undefined"!=typeof window&&(window.addEventListener("online",(function(){console.log("Device is online, processing sync queue..."),t.processSyncQueue()})),"serviceWorker"in navigator&&navigator.serviceWorker.addEventListener("message",(function(e){e.data&&"SYNC_STORIES"===e.data.type&&(console.log("Received sync trigger from service worker"),t.processSyncQueue())})))}}],e&&k(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a,c,s,u,l}());function L(t){return L="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},L(t)}function O(t,e){var r=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),r.push.apply(r,n)}return r}function j(t){for(var e=1;e<arguments.length;e++){var r=null!=arguments[e]?arguments[e]:{};e%2?O(Object(r),!0).forEach((function(e){P(t,e,r[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(r)):O(Object(r)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(r,e))}))}return t}function P(t,e,r){return(e=A(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function _(){_=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),c=new I(n||[]);return o(a,"_invoke",{value:j(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function g(){}function m(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(A([])));k&&k!==r&&n.call(k,a)&&(w=k);var E=b.prototype=g.prototype=Object.create(w);function S(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function O(t,e){function r(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==L(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function j(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=P(c,n);if(s){if(s===y)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?v:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=v,n.method="throw",n.arg=u.arg)}}}function P(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,P(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function N(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function T(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function I(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(N,this),this.reset(!0)}function A(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(L(e)+" is not iterable")}return m.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:m,configurable:!0}),m.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(O.prototype),u(O.prototype,c,(function(){return this})),e.AsyncIterator=O,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new O(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},S(E),u(E,s,"Generator"),u(E,a,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=A,I.prototype={constructor:I,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(T),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),T(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;T(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:A(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function N(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function T(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){N(i,n,o,a,c,"next",t)}function c(t){N(i,n,o,a,c,"throw",t)}a(void 0)}))}}function I(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,A(n.key),n)}}function A(t){var e=function(t){if("object"!=L(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=L(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==L(e)?e:e+""}S.openDatabase().then((function(){S.setupSyncListeners()}));var F="https://story-api.dicoding.dev/v1";const G=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),S.openDatabase().catch((function(t){console.error("Failed to open IndexedDB:",t)}))},e=[{key:"register",value:(s=T(_().mark((function t(e,r,n){var o,i,a;return _().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(F,"/register"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({name:e,email:r,password:n})});case 3:if((o=t.sent).ok){t.next=9;break}return t.next=7,o.json().catch((function(){return{message:"Registration failed"}}));case 7:throw i=t.sent,new Error(i.message||"Registration failed");case 9:return t.next=11,o.json();case 11:return a=t.sent,t.abrupt("return",a);case 15:if(t.prev=15,t.t0=t.catch(0),"Failed to fetch"!==t.t0.message&&!t.t0.message.includes("NetworkError")){t.next=19;break}throw new Error("Network error. Please check your internet connection and try again.");case 19:throw t.t0;case 20:case"end":return t.stop()}}),t,null,[[0,15]])}))),function(t,e,r){return s.apply(this,arguments)})},{key:"login",value:(c=T(_().mark((function t(e,r){var n,o,i;return _().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(F,"/login"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({email:e,password:r})});case 3:if((n=t.sent).ok){t.next=9;break}return t.next=7,n.json().catch((function(){return{message:"Login failed"}}));case 7:throw o=t.sent,new Error(o.message||"Login failed");case 9:return t.next=11,n.json();case 11:return i=t.sent,t.abrupt("return",i);case 15:if(t.prev=15,t.t0=t.catch(0),"Failed to fetch"!==t.t0.message&&!t.t0.message.includes("NetworkError")){t.next=19;break}throw new Error("Network error. Please check your internet connection and try again.");case 19:throw t.t0;case 20:case"end":return t.stop()}}),t,null,[[0,15]])}))),function(t,e){return c.apply(this,arguments)})},{key:"getAllStories",value:(a=T(_().mark((function t(e){var r,n,o,i,a,c,s=arguments;return _().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(r=s.length>1&&void 0!==s[1]&&s[1],!navigator.onLine||r){t.next=25;break}return t.prev=2,t.next=5,fetch("".concat(F,"/stories"),{headers:{Authorization:"Bearer ".concat(e)}});case 5:if((n=t.sent).ok){t.next=13;break}return t.next=9,n.json().catch((function(){return{message:"Failed to fetch stories"}}));case 9:o=t.sent,console.warn("Failed to fetch stories from server:",o.message),t.next=20;break;case 13:return t.next=15,n.json();case 15:return i=t.sent,a=i.listStory||[],t.next=19,Promise.all(a.map((function(t){return S.addStory(t)})));case 19:return t.abrupt("return",a);case 20:t.next=25;break;case 22:t.prev=22,t.t0=t.catch(2),console.warn("Network error, using cached data:",t.t0.message);case 25:return t.prev=25,t.next=28,S.getStories();case 28:if(!((c=t.sent)&&c.length>0)){t.next=31;break}return t.abrupt("return",c);case 31:throw new Error("No cached stories available");case 34:throw t.prev=34,t.t1=t.catch(25),console.error("Error getting stories from cache:",t.t1),new Error("Unable to load stories. Please check your connection and try again.");case 38:case"end":return t.stop()}}),t,null,[[2,22],[25,34]])}))),function(t){return a.apply(this,arguments)})},{key:"addStory",value:(i=T(_().mark((function t(e,r){var n,o,i,a,c,s,u,l,f,h,p,d,v,y,g,m,b;return _().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(n=r.description,o=r.photo,i=r.lat,a=r.lon,c=null,s=null,!(o instanceof File)){t.next=8;break}return t.next=6,o.arrayBuffer();case 6:c=t.sent,s={name:o.name,type:o.type,size:o.size,blob:c};case 8:if(u={description:n,photo:s,lat:i?parseFloat(i):null,lon:a?parseFloat(a):null,createdAt:(new Date).toISOString(),isLocal:!0},navigator.onLine){t.next=26;break}return t.prev=11,l="local-".concat(Date.now(),"-").concat(Math.random().toString(36).substring(2,11)),t.next=15,S.addStory(j(j({},u),{},{id:l}));case 15:return f=t.sent,h={description:n,lat:i?parseFloat(i):null,lon:a?parseFloat(a):null},t.next=19,S.addToSyncQueue({type:"sync-stories",data:h,method:"POST",url:"".concat(F,"/stories"),headers:{Authorization:"Bearer ".concat(e),"Content-Type":"multipart/form-data"},meta:{localId:l,photoName:o.name,photoType:o.type}});case 19:return t.abrupt("return",j(j({},f),{},{message:"Story saved locally. Will be synced when online.",isLocal:!0}));case 22:throw t.prev=22,t.t0=t.catch(11),console.error("Error saving story offline:",t.t0),new Error("Failed to save story. Please try again later.");case 26:return t.prev=26,(p=new FormData).append("description",n),p.append("photo",o),i&&a&&(p.append("lat",i.toString()),p.append("lon",a.toString())),t.next=33,fetch("".concat(F,"/stories"),{method:"POST",headers:{Authorization:"Bearer ".concat(e)},body:p});case 33:return d=t.sent,t.next=36,d.json();case 36:if(v=t.sent,d.ok){t.next=39;break}throw new Error(v.message);case 39:if(!v.story){t.next=42;break}return t.next=42,S.addStory(v.story);case 42:return t.abrupt("return",v);case 45:if(t.prev=45,t.t1=t.catch(26),console.error("Error adding story online, trying to save offline:",t.t1),!navigator.onLine){t.next=76;break}if(t.prev=49,y="local-".concat(Date.now(),"-").concat(Math.random().toString(36).substring(2,11)),!(o instanceof File)){t.next=61;break}return t.t3=o.name,t.t4=o.type,t.t5=o.size,t.next=57,o.arrayBuffer();case 57:t.t6=t.sent,t.t2={name:t.t3,type:t.t4,size:t.t5,blob:t.t6},t.next=62;break;case 61:t.t2=null;case 62:return g=t.t2,m={id:y,description:n,photo:g,lat:i?parseFloat(i):null,lon:a?parseFloat(a):null,createdAt:(new Date).toISOString(),isLocal:!0},t.next=66,S.addStory(m);case 66:return b=t.sent,t.next=69,S.addToSyncQueue({type:"sync-stories",data:{description:n,lat:i?parseFloat(i):null,lon:a?parseFloat(a):null},method:"POST",url:"".concat(F,"/stories"),headers:{Authorization:"Bearer ".concat(e),"Content-Type":"multipart/form-data"},meta:{localId:y,photoName:o instanceof File?o.name:null,photoType:o instanceof File?o.type:null}});case 69:return t.abrupt("return",j(j({},b),{},{message:"Story saved locally. Will be synced when connection is stable.",isLocal:!0}));case 72:throw t.prev=72,t.t7=t.catch(49),console.error("Error saving offline fallback:",t.t7),new Error("Failed to save story. Please try again later.");case 76:throw t.t1;case 77:case"end":return t.stop()}}),t,null,[[11,22],[26,45],[49,72]])}))),function(t,e){return i.apply(this,arguments)})},{key:"toggleFavoriteStory",value:(o=T(_().mark((function t(e,r){var n,o;return _().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e&&r){t.next=2;break}throw new Error("Token and storyId are required");case 2:if(t.prev=2,!this.getFavorites().includes(r)){t.next=13;break}return t.next=8,this.unfavoriteStory(e,r);case 8:return(n=t.sent)&&(!1===n.favorited||n.message)&&this.removeFavorite(r),t.abrupt("return",{favorited:!1});case 13:return t.next=15,this.favoriteStory(e,r);case 15:return(o=t.sent)&&(!0===o.favorited||o.message)&&this.addFavorite(r),t.abrupt("return",{favorited:!0});case 18:t.next=34;break;case 20:if(t.prev=20,t.t0=t.catch(2),console.error("Error toggling favorite:",t.t0),"Failed to fetch"!==t.t0.message&&!t.t0.message.includes("NetworkError")){t.next=33;break}if(!this.getFavorites().includes(r)){t.next=31;break}return this.removeFavorite(r),t.abrupt("return",{favorited:!1});case 31:return this.addFavorite(r),t.abrupt("return",{favorited:!0});case 33:throw t.t0;case 34:case"end":return t.stop()}}),t,this,[[2,20]])}))),function(t,e){return o.apply(this,arguments)})},{key:"favoriteStory",value:(n=T(_().mark((function t(e,r){var n,o,i;return _().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(F,"/stories/").concat(r,"/favorite"),{method:"POST",headers:{Authorization:"Bearer ".concat(e)}});case 3:if((n=t.sent).ok){t.next=9;break}return t.next=7,n.json().catch((function(){return{message:"Failed to favorite story"}}));case 7:throw o=t.sent,new Error(o.message||"Failed to favorite story");case 9:return t.next=11,n.json().catch((function(){return{}}));case 11:return i=t.sent,t.abrupt("return",i);case 15:if(t.prev=15,t.t0=t.catch(0),navigator.onLine&&"Failed to fetch"!==t.t0.message&&!t.t0.message.includes("NetworkError")){t.next=28;break}return t.prev=18,t.next=21,S.addToSyncQueue({type:"favorite-story",data:{storyId:r},method:"POST",url:"".concat(F,"/stories/").concat(r,"/favorite"),headers:{Authorization:"Bearer ".concat(e)}});case 21:t.next=26;break;case 23:t.prev=23,t.t1=t.catch(18),console.error("Error adding to sync queue:",t.t1);case 26:return this.addFavorite(r),t.abrupt("return",{favorited:!0,message:"Story favorited locally. Will sync when online."});case 28:throw t.t0;case 29:case"end":return t.stop()}}),t,this,[[0,15],[18,23]])}))),function(t,e){return n.apply(this,arguments)})},{key:"unfavoriteStory",value:(r=T(_().mark((function t(e,r){var n,o,i;return _().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,fetch("".concat(F,"/stories/").concat(r,"/favorite"),{method:"DELETE",headers:{Authorization:"Bearer ".concat(e)}});case 3:if((n=t.sent).ok){t.next=9;break}return t.next=7,n.json().catch((function(){return{message:"Failed to unfavorite story"}}));case 7:throw o=t.sent,new Error(o.message||"Failed to unfavorite story");case 9:return t.next=11,n.json().catch((function(){return{}}));case 11:return i=t.sent,t.abrupt("return",i);case 15:if(t.prev=15,t.t0=t.catch(0),navigator.onLine&&"Failed to fetch"!==t.t0.message&&!t.t0.message.includes("NetworkError")){t.next=28;break}return t.prev=18,t.next=21,S.addToSyncQueue({type:"unfavorite-story",data:{storyId:r},method:"DELETE",url:"".concat(F,"/stories/").concat(r,"/favorite"),headers:{Authorization:"Bearer ".concat(e)}});case 21:t.next=26;break;case 23:t.prev=23,t.t1=t.catch(18),console.error("Error adding to sync queue:",t.t1);case 26:return this.removeFavorite(r),t.abrupt("return",{favorited:!1,message:"Story unfavorited locally. Will sync when online."});case 28:throw t.t0;case 29:case"end":return t.stop()}}),t,this,[[0,15],[18,23]])}))),function(t,e){return r.apply(this,arguments)})},{key:"getFavorites",value:function(){try{var t=localStorage.getItem("favorites");return t?JSON.parse(t):[]}catch(t){return console.error("Error getting favorites:",t),[]}}},{key:"addFavorite",value:function(t){var e=this.getFavorites();e.includes(t)||(e.push(t),localStorage.setItem("favorites",JSON.stringify(e)))}},{key:"removeFavorite",value:function(t){var e=this.getFavorites(),r=e.indexOf(t);r>-1&&(e.splice(r,1),localStorage.setItem("favorites",JSON.stringify(e)))}},{key:"isFavorited",value:function(t){return this.getFavorites().includes(t)}}],e&&I(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n,o,i,a,c,s}());var M=r(481),D=r.n(M);function C(t){return C="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},C(t)}function B(t,e){(null==e||e>t.length)&&(e=t.length);for(var r=0,n=Array(e);r<e;r++)n[r]=t[r];return n}function q(){q=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),c=new N(n||[]);return o(a,"_invoke",{value:O(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function g(){}function m(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(T([])));k&&k!==r&&n.call(k,a)&&(w=k);var E=b.prototype=g.prototype=Object.create(w);function S(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function r(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==C(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function O(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=j(c,n);if(s){if(s===y)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?v:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=v,n.method="throw",n.arg=u.arg)}}}function j(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,j(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function N(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(C(e)+" is not iterable")}return m.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:m,configurable:!0}),m.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(L.prototype),u(L.prototype,c,(function(){return this})),e.AsyncIterator=L,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new L(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},S(E),u(E,s,"Generator"),u(E,a,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function z(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function W(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){z(i,n,o,a,c,"next",t)}function c(t){z(i,n,o,a,c,"throw",t)}a(void 0)}))}}function R(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,U(n.key),n)}}function U(t){var e=function(t){if("object"!=C(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=C(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==C(e)?e:e+""}function H(t,e,r){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,r)}function Y(t,e){return t.get(J(t,e))}function Q(t,e,r){return t.set(J(t,e),r),r}function J(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var V=new WeakMap,K=new WeakMap,X=new WeakMap,Z=new WeakMap,$=new WeakMap,tt=new WeakMap,et=new WeakMap,rt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),H(this,V,null),H(this,K,[]),H(this,X,[]),H(this,Z,null),H(this,$,""),H(this,tt,"newest"),H(this,et,"all")},e=[{key:"render",value:(s=W(q().mark((function t(){return q().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="container home-page">\n        <div class="page-header">\n          <div class="header-content">\n            <h1>Story Map</h1>\n            <button id="logout-button" class="logout-button" aria-label="Logout from your account">Logout</button>\n          </div>\n          <button id="add-story-button" class="add-story-button" aria-label="Add a new story">Add New Story</button>\n        </div>\n        <div class="content-wrapper">\n          <div class="story-list" id="story-list">\n            <div class="story-controls">\n              <h2>Stories</h2>\n              <div class="controls-row">\n                <div class="search-box">\n                  <input \n                    type="text" \n                    id="search-input" \n                    placeholder="Search stories..." \n                    aria-label="Search stories by name or description"\n                    class="search-input">\n                </div>\n                <div class="filter-controls">\n                  <select id="sort-select" aria-label="Sort stories" class="sort-select">\n                    <option value="newest">Newest First</option>\n                    <option value="oldest">Oldest First</option>\n                    <option value="name-asc">Name (A-Z)</option>\n                    <option value="name-desc">Name (Z-A)</option>\n                  </select>\n                  <select id="filter-select" aria-label="Filter stories" class="filter-select">\n                    <option value="all">All Stories</option>\n                    <option value="with-location">With Location</option>\n                    <option value="without-location">Without Location</option>\n                  </select>\n                </div>\n              </div>\n            </div>\n            <div class="stories-container" role="region" aria-label="List of stories" aria-live="polite">Loading stories...</div>\n          </div>\n          <div class="map-container">\n            <div id="map" role="application" aria-label="Map showing story locations"></div>\n          </div>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return s.apply(this,arguments)})},{key:"afterRender",value:(c=W(q().mark((function t(){var e,n,o,i,a;return q().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,localStorage.getItem("token")){t.next=5;break}return"#/login"!==window.location.hash&&(window.location.hash="#/login"),t.abrupt("return");case 5:return(e=document.getElementById("logout-button"))&&(n=e.cloneNode(!0),e.parentNode.replaceChild(n,e),n.addEventListener("click",function(){var t=W(q().mark((function t(e){return q().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e.preventDefault(),e.stopPropagation(),localStorage.removeItem("token"),localStorage.removeItem("userId"),localStorage.removeItem("name"),window.location.hash="#/login",W(q().mark((function t(){return q().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,t.t0=window.HeaderNotification,t.t0){t.next=6;break}return t.next=5,Promise.resolve().then(r.bind(r,895));case 5:t.t0=t.sent.default;case 6:t.t0.info("Sampai Jumpa!","Anda telah logout dari Story Map.",3e3),t.next=13;break;case 10:t.prev=10,t.t1=t.catch(0),console.error("Error showing header notification:",t.t1);case 13:case"end":return t.stop()}}),t,null,[[0,10]])})))(),W(q().mark((function t(){var e;return q().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,t.t0=window.NotificationHelper,t.t0){t.next=6;break}return t.next=5,Promise.resolve().then(r.bind(r,17));case 5:t.t0=t.sent.default;case 6:return e=t.t0,t.next=9,e.showLocalNotification("Sampai Jumpa!",{body:"Anda telah logout dari Story Map.",tag:"logout"});case 9:t.next=14;break;case 11:t.prev=11,t.t1=t.catch(0),console.error("Error showing browser notification:",t.t1);case 14:case"end":return t.stop()}}),t,null,[[0,11]])})))();case 8:case"end":return t.stop()}}),t)})));return function(e){return t.apply(this,arguments)}}())),(o=document.getElementById("add-story-button"))&&(i=o.cloneNode(!0),o.parentNode.replaceChild(i,o),i.addEventListener("click",(function(){window.location.hash="#/add"}))),t.prev=9,t.next=12,this._initializeMap();case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(9),console.error("Error initializing map:",t.t0);case 17:return t.prev=17,t.next=20,this._loadStories();case 20:t.next=27;break;case 22:t.prev=22,t.t1=t.catch(17),console.error("Error loading stories:",t.t1),(a=document.querySelector(".stories-container"))&&(a.innerHTML='<p role="alert">Error loading stories. Please try again later.</p>');case 27:try{this._setupControls()}catch(t){console.error("Error setting up controls:",t)}t.next=33;break;case 30:t.prev=30,t.t2=t.catch(0),console.error("Error in afterRender:",t.t2);case 33:case"end":return t.stop()}}),t,this,[[0,30],[9,14],[17,22]])}))),function(){return c.apply(this,arguments)})},{key:"_setupControls",value:function(){var t=this;try{var e=document.getElementById("search-input"),r=document.getElementById("sort-select"),n=document.getElementById("filter-select");if(e){var o=e.cloneNode(!0);e.parentNode.replaceChild(o,e),o.addEventListener("input",(function(e){Q($,t,e.target.value.toLowerCase().trim()),t._applyFilters()}))}if(r){var i=r.cloneNode(!0);r.parentNode.replaceChild(i,r),i.addEventListener("change",(function(e){Q(tt,t,e.target.value),t._applyFilters()}))}if(n){var a=n.cloneNode(!0);n.parentNode.replaceChild(a,n),a.addEventListener("change",(function(e){Q(et,t,e.target.value),t._applyFilters()}))}}catch(t){console.error("Error setting up controls:",t)}}},{key:"_applyFilters",value:function(){var t=this,e=function(t){return function(t){if(Array.isArray(t))return B(t)}(t)||function(t){if("undefined"!=typeof Symbol&&null!=t[Symbol.iterator]||null!=t["@@iterator"])return Array.from(t)}(t)||function(t,e){if(t){if("string"==typeof t)return B(t,e);var r={}.toString.call(t).slice(8,-1);return"Object"===r&&t.constructor&&(r=t.constructor.name),"Map"===r||"Set"===r?Array.from(t):"Arguments"===r||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(r)?B(t,e):void 0}}(t)||function(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}()}(Y(K,this));Y($,this)&&(e=e.filter((function(e){return e.name.toLowerCase().includes(Y($,t))||e.description.toLowerCase().includes(Y($,t))}))),"with-location"===Y(et,this)?e=e.filter((function(t){return t.lat&&t.lon})):"without-location"===Y(et,this)&&(e=e.filter((function(t){return!t.lat||!t.lon}))),e.sort((function(e,r){switch(Y(tt,t)){case"newest":return new Date(r.createdAt)-new Date(e.createdAt);case"oldest":return new Date(e.createdAt)-new Date(r.createdAt);case"name-asc":return e.name.localeCompare(r.name);case"name-desc":return r.name.localeCompare(e.name);default:return 0}})),Q(X,this,e),this._renderStories(e),this._renderMarkers(e)}},{key:"_initializeMap",value:(a=W(q().mark((function t(){var e,n;return q().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.next=2,Promise.resolve().then(r.bind(r,903));case 2:e=t.sent,n=e.default,Q(V,this,n.initializeMap("map"));case 5:case"end":return t.stop()}}),t,this)}))),function(){return a.apply(this,arguments)})},{key:"_loadStories",value:(i=W(q().mark((function t(){var e,r,n;return q().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=localStorage.getItem("token")){t.next=4;break}return t.abrupt("return");case 4:return t.next=6,G.getAllStories(e);case 6:r=t.sent,Q(K,this,r),Q(X,this,r),this._applyFilters(),t.next=17;break;case 12:t.prev=12,t.t0=t.catch(0),console.error("Error loading stories:",t.t0),(n=document.querySelector(".stories-container"))&&(n.innerHTML='<p role="alert">Error loading stories. Please try again later.</p>',n.setAttribute("aria-live","assertive"));case 17:case"end":return t.stop()}}),t,this,[[0,12]])}))),function(){return i.apply(this,arguments)})},{key:"_renderStories",value:function(t){var e=this,n=document.querySelector(".stories-container");if(n)if(t&&t.length){try{var o=t.map((function(t){if(!t||!t.id)return"";var r=t.createdAt?new Date(t.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"",n=!1;try{n=G.isFavorited(t.id)}catch(t){console.error("Error checking favorite status:",t)}var o=n?"favorited":"",i=n?"":"";return'\n          <article class="story-item '.concat(t.id===Y(Z,e)?"active":"",'" data-id="').concat(t.id,'" role="article" tabindex="0" aria-label="Story by ').concat(t.name||"Unknown",'">\n            <img src="').concat(t.photoUrl||"",'" alt="Photo from ').concat(t.name||"Unknown","\" class=\"story-image\" loading=\"lazy\" onerror=\"this.src='data:image/svg+xml,%3Csvg xmlns=\\'http://www.w3.org/2000/svg\\' width=\\'100\\' height=\\'100\\'%3E%3Crect fill=\\'%23ddd\\' width=\\'100\\' height=\\'100\\'/%3E%3Ctext x=\\'50%25\\' y=\\'50%25\\' text-anchor=\\'middle\\' dy=\\'.3em\\' fill=\\'%23999\\'%3ENo Image%3C/text%3E%3C/svg%3E'\">\n            <div class=\"story-content\">\n              <div class=\"story-header\">\n                <h3>").concat(t.name||"Unknown",'</h3>\n                <button class="favorite-btn ').concat(o,'" data-story-id="').concat(t.id,'" aria-label="').concat(n?"Remove from favorites":"Add to favorites",'" title="').concat(n?"Remove from favorites":"Add to favorites",'">\n                  <span class="favorite-icon">').concat(i,'</span>\n                </button>\n              </div>\n              <p class="story-description">').concat(t.description||"",'</p>\n              <time class="story-date" datetime="').concat(t.createdAt||"",'">').concat(r,"</time>\n            </div>\n          </article>\n        ")})).filter((function(t){return""!==t})).join("");n.innerHTML=o}catch(t){console.error("Error rendering stories:",t),n.innerHTML='<p role="alert">Error rendering stories. Please refresh the page.</p>'}try{document.querySelectorAll(".story-item").forEach((function(t){var n=t.dataset.id;n&&t.addEventListener("click",function(){var t=W(q().mark((function t(o){var i;return q().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!o.target.closest(".favorite-btn")){t.next=2;break}return t.abrupt("return");case 2:if(t.prev=2,!((i=Y(K,e).find((function(t){return t&&t.id===n})))&&i.lat&&i.lon)){t.next=12;break}return t.next=7,Promise.resolve().then(r.bind(r,903));case 7:t.sent.default.setView(i.lat,i.lon,15),Q(Z,e,n),e._highlightActiveStory(n);case 12:t.next=17;break;case 14:t.prev=14,t.t0=t.catch(2),console.error("Error handling story click:",t.t0);case 17:case"end":return t.stop()}}),t,null,[[2,14]])})));return function(e){return t.apply(this,arguments)}}())})),document.querySelectorAll(".favorite-btn").forEach((function(t){var r=t.dataset.storyId;r&&t.addEventListener("click",function(){var n=W(q().mark((function n(o){return q().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:return o.stopPropagation(),o.preventDefault(),n.prev=2,n.next=5,e._toggleFavorite(r,t);case 5:n.next=10;break;case 7:n.prev=7,n.t0=n.catch(2),console.error("Error toggling favorite:",n.t0);case 10:case"end":return n.stop()}}),n,null,[[2,7]])})));return function(t){return n.apply(this,arguments)}}())}))}catch(t){console.error("Error setting up event listeners:",t)}}else n.innerHTML="<p>No stories found.</p>";else console.error("Stories container not found")}},{key:"_renderMarkers",value:(o=W(q().mark((function t(e){var n,o,i,a,c,s=this;return q().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e&&Array.isArray(e)&&0!==e.length){t.next=3;break}return t.abrupt("return");case 3:return t.next=5,Promise.resolve().then(r.bind(r,903));case 5:if(n=t.sent,o=n.default){t.next=10;break}return console.error("Map service not available"),t.abrupt("return");case 10:if(o.clearMarkers(),i=D().latLngBounds(),a=!1,e.forEach((function(t){if(t&&t.id&&t.lat&&t.lon&&!isNaN(t.lat)&&!isNaN(t.lon)){a=!0;var e=t.createdAt?new Date(t.createdAt).toLocaleDateString("en-US",{year:"numeric",month:"short",day:"numeric"}):"";try{var r=o.addMarker(t.lat,t.lon,{title:t.name||"Unknown"});r&&(r.bindPopup('\n                <div class="marker-popup">\n                  <img src="'.concat(t.photoUrl||"",'" alt="Photo from ').concat(t.name||"Unknown",'" class="popup-image" onerror="this.style.display=\'none\'">\n                  <h3>').concat(t.name||"Unknown","</h3>\n                  <p>").concat(t.description||"",'</p>\n                  <time class="popup-date">').concat(e,"</time>\n                </div>\n              ")),r.on("click",(function(){t.id&&(Q(Z,s,t.id),s._highlightActiveStory(t.id))})),i.extend([t.lat,t.lon]))}catch(t){console.error("Error adding marker:",t)}}})),a)try{(c=o.getMap())&&c.fitBounds(i,{padding:[50,50]})}catch(t){console.error("Error fitting bounds:",t)}t.next=20;break;case 17:t.prev=17,t.t0=t.catch(0),console.error("Error rendering markers:",t.t0);case 20:case"end":return t.stop()}}),t,null,[[0,17]])}))),function(t){return o.apply(this,arguments)})},{key:"_highlightActiveStory",value:function(t){document.querySelectorAll(".story-item").forEach((function(e){e.classList.toggle("active",e.dataset.id===t)}))}},{key:"_toggleFavorite",value:(n=W(q().mark((function t(e,r){var n,o,i,a;return q().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(e&&r){t.next=3;break}return console.error("Invalid storyId or buttonElement"),t.abrupt("return");case 3:if(t.prev=3,n=localStorage.getItem("token")){t.next=8;break}return"#/login"!==window.location.hash&&(alert("Please login to favorite stories"),window.location.hash="#/login"),t.abrupt("return");case 8:return r.disabled=!0,o=r.querySelector(".favorite-icon"),t.prev=10,t.next=13,G.toggleFavoriteStory(n,e);case 13:(i=t.sent)?(o&&(i.favorited?(r.classList.add("favorited"),o.textContent="",r.setAttribute("aria-label","Remove from favorites"),r.setAttribute("title","Remove from favorites")):(r.classList.remove("favorited"),o.textContent="",r.setAttribute("aria-label","Add to favorites"),r.setAttribute("title","Add to favorites"))),i.message&&console.log(i.message)):console.error("No result from toggleFavoriteStory");case 15:return t.prev=15,r.disabled=!1,t.finish(15);case 18:t.next=27;break;case 20:t.prev=20,t.t0=t.catch(3),console.error("Error toggling favorite:",t.t0),(a=r.querySelector(".favorite-icon"))&&(G.isFavorited(e)?(r.classList.add("favorited"),a.textContent=""):(r.classList.remove("favorited"),a.textContent="")),r.disabled=!1,!t.t0.message||t.t0.message.includes("Failed to fetch")||t.t0.message.includes("NetworkError")||alert("Failed to update favorite: ".concat(t.t0.message));case 27:case"end":return t.stop()}}),t,null,[[3,20],[10,,15,18]])}))),function(t,e){return n.apply(this,arguments)})}],e&&R(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,o,i,a,c,s}();function nt(t){return nt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},nt(t)}function ot(){ot=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),c=new N(n||[]);return o(a,"_invoke",{value:O(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function g(){}function m(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(T([])));k&&k!==r&&n.call(k,a)&&(w=k);var E=b.prototype=g.prototype=Object.create(w);function S(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function r(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==nt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function O(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=j(c,n);if(s){if(s===y)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?v:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=v,n.method="throw",n.arg=u.arg)}}}function j(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,j(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function N(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(nt(e)+" is not iterable")}return m.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:m,configurable:!0}),m.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(L.prototype),u(L.prototype,c,(function(){return this})),e.AsyncIterator=L,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new L(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},S(E),u(E,s,"Generator"),u(E,a,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function it(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function at(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){it(i,n,o,a,c,"next",t)}function c(t){it(i,n,o,a,c,"throw",t)}a(void 0)}))}}function ct(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,st(n.key),n)}}function st(t){var e=function(t){if("object"!=nt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=nt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==nt(e)?e:e+""}var ut=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"render",value:(n=at(ot().mark((function t(){return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="container">\n        <h1>About Page</h1>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(r=at(ot().mark((function t(){return ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})}],e&&ct(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}(),lt=r(903);function ft(t){return ft="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},ft(t)}function ht(){ht=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),c=new N(n||[]);return o(a,"_invoke",{value:O(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function g(){}function m(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(T([])));k&&k!==r&&n.call(k,a)&&(w=k);var E=b.prototype=g.prototype=Object.create(w);function S(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function r(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==ft(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function O(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=j(c,n);if(s){if(s===y)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?v:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=v,n.method="throw",n.arg=u.arg)}}}function j(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,j(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function N(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(ft(e)+" is not iterable")}return m.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:m,configurable:!0}),m.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(L.prototype),u(L.prototype,c,(function(){return this})),e.AsyncIterator=L,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new L(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},S(E),u(E,s,"Generator"),u(E,a,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function pt(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function dt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){pt(i,n,o,a,c,"next",t)}function c(t){pt(i,n,o,a,c,"throw",t)}a(void 0)}))}}function vt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,yt(n.key),n)}}function yt(t){var e=function(t){if("object"!=ft(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=ft(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==ft(e)?e:e+""}function gt(t,e,r){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,r)}function mt(t,e){return t.get(wt(t,e))}function bt(t,e,r){return t.set(wt(t,e),r),r}function wt(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var xt=new WeakMap,kt=new WeakMap,Et=new WeakMap,St=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),gt(this,xt,null),gt(this,kt,null),gt(this,Et,null)},e=[{key:"render",value:(i=dt(ht().mark((function t(){return ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="container add-story-page">\n        <h1>Add New Story</h1>\n        <form id="add-story-form" class="add-story-form">\n          <div class="form-group">\n            <label for="description">Story Description</label>\n            <textarea \n              id="description" \n              name="description" \n              required \n              placeholder="Tell your story..."\n              aria-required="true"></textarea>\n          </div>\n\n          <div class="form-group">\n            <label for="photo">Photo</label>\n            <div class="photo-input-container">\n              <input \n                type="file" \n                id="photo" \n                name="photo" \n                accept="image/*" \n                required\n                aria-required="true">\n              <button type="button" id="camera-button" class="camera-button">\n                Take Photo\n              </button>\n            </div>\n            <div id="photo-preview" class="photo-preview"></div>\n          </div>\n\n          <div class="form-group">\n            <label for="location-map">Location</label>\n            <div id="location-map" class="location-map" role="application" aria-label="Map to select story location" tabindex="0"></div>\n            <p class="location-help" id="location-help">Click on the map to select a location for your story</p>\n          </div>\n\n          <div class="form-actions">\n            <button type="button" id="cancel-button" class="cancel-button" aria-label="Cancel adding story">Cancel</button>\n            <button type="submit" class="submit-button" aria-label="Submit and share your story">Share Story</button>\n          </div>\n        </form>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return i.apply(this,arguments)})},{key:"afterRender",value:(o=dt(ht().mark((function t(){return ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(localStorage.getItem("token")){t.next=4;break}return window.location.hash="#/login",t.abrupt("return");case 4:this._initializeMap(),this._setupForm(),this._setupCamera();case 7:case"end":return t.stop()}}),t,this)}))),function(){return o.apply(this,arguments)})},{key:"_initializeMap",value:function(){var t=this;bt(kt,this,lt.default.initializeMap("location-map",{zoom:5})),mt(kt,this).on("click",(function(e){var r=e.latlng,n=r.lat,o=r.lng;bt(xt,t,{lat:n,lng:o}),mt(Et,t)&&lt.default.removeMarker(mt(Et,t)),bt(Et,t,lt.default.addMarker(n,o,{draggable:!0})),mt(Et,t).on("dragend",(function(e){var r=e.target.getLatLng();bt(xt,t,{lat:r.lat,lng:r.lng})}))}))}},{key:"_setupForm",value:function(){var t=this,e=document.getElementById("add-story-form"),n=document.getElementById("photo"),o=document.getElementById("photo-preview"),i=document.getElementById("cancel-button"),a=e.querySelector('button[type="submit"]'),c=!1;e.addEventListener("submit",function(){var n=dt(ht().mark((function n(o){var i,s,u,l,f,h;return ht().wrap((function(n){for(;;)switch(n.prev=n.next){case 0:if(o.preventDefault(),!c){n.next=3;break}return n.abrupt("return");case 3:if(c=!0,a.disabled=!0,a.setAttribute("aria-busy","true"),a.textContent="Sharing...",n.prev=7,i=localStorage.getItem("token")){n.next=13;break}return alert("Please login first to add a story"),window.location.hash="#/login",n.abrupt("return");case 13:if(s=new FormData(e),u=s.get("description").trim(),l=s.get("photo"),u){n.next=18;break}throw new Error("Please enter a description");case 18:if(l&&0!==l.size){n.next=20;break}throw new Error("Please select a photo");case 20:if(mt(xt,t)){n.next=22;break}throw new Error("Please select a location on the map");case 22:return f={description:u,photo:l,lat:mt(xt,t).lat,lon:mt(xt,t).lng},n.next=25,G.addStory(i,f);case 25:if(n.sent,n.prev=26,n.t0=window.HeaderNotification,n.t0){n.next=32;break}return n.next=31,Promise.resolve().then(r.bind(r,895));case 31:n.t0=n.sent.default;case 32:if(n.t0.success("Story Berhasil Dibagikan!","Story Anda telah berhasil ditambahkan ke peta.",4e3),n.t1=window.NotificationHelper,n.t1){n.next=39;break}return n.next=38,Promise.resolve().then(r.bind(r,17));case 38:n.t1=n.sent.default;case 39:return h=n.t1,n.next=42,h.showLocalNotification("Story Berhasil Dibagikan!",{body:"Story Anda telah berhasil ditambahkan ke peta.",tag:"story-added",data:{url:"/"}});case 42:n.next=48;break;case 44:n.prev=44,n.t2=n.catch(26),console.error("Error showing notification:",n.t2),alert("Story shared successfully!");case 48:window.location.hash="/",n.next=68;break;case 51:if(n.prev=51,n.t3=n.catch(7),console.error("Error adding story:",n.t3),n.prev=54,n.t4=window.HeaderNotification,n.t4){n.next=60;break}return n.next=59,Promise.resolve().then(r.bind(r,895));case 59:n.t4=n.sent.default;case 60:n.t4.error("Gagal Membagikan Story",n.t3.message||"Failed to share story. Please try again.",6e3),n.next=68;break;case 64:n.prev=64,n.t5=n.catch(54),console.error("Error showing error notification:",n.t5),alert("Failed to share story: ".concat(n.t3.message));case 68:return n.prev=68,c=!1,a.disabled=!1,a.setAttribute("aria-busy","false"),a.textContent="Share Story",n.finish(68);case 74:case"end":return n.stop()}}),n,null,[[7,51,68,74],[26,44],[54,64]])})));return function(t){return n.apply(this,arguments)}}()),i.addEventListener("click",(function(){window.location.hash="/"})),n.addEventListener("change",(function(t){var e=t.target.files[0];if(e){var r=new FileReader;r.onload=function(t){o.innerHTML='\n            <img src="'.concat(t.target.result,'" alt="Preview" class="preview-image">\n          ')},r.readAsDataURL(e)}}))}},{key:"_setupCamera",value:(n=dt(ht().mark((function t(){var e,r,n;return ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=document.getElementById("camera-button"),r=document.getElementById("photo-preview"),n=document.getElementById("photo"),e.addEventListener("click",dt(ht().mark((function t(){var e,o;return ht().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,navigator.mediaDevices.getUserMedia({video:!0});case 3:e=t.sent,r.innerHTML='\n          <video autoplay class="camera-preview"></video>\n          <button type="button" class="capture-button">Take Photo</button>\n        ',(o=document.querySelector(".camera-preview")).srcObject=e,document.querySelector(".capture-button").addEventListener("click",(function(){var t=document.createElement("canvas");t.width=o.videoWidth,t.height=o.videoHeight,t.getContext("2d").drawImage(o,0,0),t.toBlob((function(o){var i=new File([o],"camera-photo.jpg",{type:"image/jpeg"}),a=new DataTransfer;a.items.add(i),n.files=a.files,r.innerHTML='\n              <img src="'.concat(t.toDataURL(),'" alt="Preview" class="preview-image">\n            '),e.getTracks().forEach((function(t){return t.stop()}))}),"image/jpeg")})),t.next=15;break;case 11:t.prev=11,t.t0=t.catch(0),console.error("Error accessing camera:",t.t0),alert("Could not access camera. Please make sure you have granted camera permissions.");case 15:case"end":return t.stop()}}),t,null,[[0,11]])}))));case 4:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})}],e&&vt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,o,i}();function Lt(t){return Lt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},Lt(t)}function Ot(){Ot=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),c=new N(n||[]);return o(a,"_invoke",{value:O(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function g(){}function m(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(T([])));k&&k!==r&&n.call(k,a)&&(w=k);var E=b.prototype=g.prototype=Object.create(w);function S(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function r(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==Lt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function O(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=j(c,n);if(s){if(s===y)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?v:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=v,n.method="throw",n.arg=u.arg)}}}function j(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,j(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function N(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(Lt(e)+" is not iterable")}return m.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:m,configurable:!0}),m.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(L.prototype),u(L.prototype,c,(function(){return this})),e.AsyncIterator=L,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new L(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},S(E),u(E,s,"Generator"),u(E,a,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function jt(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function Pt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){jt(i,n,o,a,c,"next",t)}function c(t){jt(i,n,o,a,c,"throw",t)}a(void 0)}))}}function _t(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Nt(n.key),n)}}function Nt(t){var e=function(t){if("object"!=Lt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=Lt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==Lt(e)?e:e+""}var Tt=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"render",value:(o=Pt(Ot().mark((function t(){return Ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="container login-page">\n        <div class="auth-container">\n          <h1>Login</h1>\n          <form id="login-form" class="auth-form">\n            <div class="form-group">\n              <label for="email">Email</label>\n              <input \n                type="email" \n                id="email" \n                name="email" \n                required \n                aria-required="true"\n                placeholder="Enter your email">\n            </div>\n\n            <div class="form-group">\n              <label for="password">Password</label>\n              <input \n                type="password" \n                id="password" \n                name="password" \n                required \n                aria-required="true"\n                placeholder="Enter your password">\n            </div>\n\n            <div class="error-message" id="error-message" role="alert" aria-live="polite"></div>\n\n            <button type="submit" class="submit-button" aria-label="Submit login form">Login</button>\n          </form>\n\n          <p class="auth-link">\n            Don\'t have an account? <button type="button" id="register-link" class="link-button">Register here</button>\n          </p>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return o.apply(this,arguments)})},{key:"afterRender",value:(n=Pt(Ot().mark((function t(){var e,n;return Ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=document.getElementById("login-form"),n=document.getElementById("error-message"),document.getElementById("register-link").addEventListener("click",(function(){window.location.hash="#/register"})),e.addEventListener("submit",function(){var t=Pt(Ot().mark((function t(e){var o,i,a,c;return Ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),t.prev=1,o=document.getElementById("email").value,i=document.getElementById("password").value,t.next=6,G.login(o,i);case 6:a=t.sent,c=a.loginResult.token,localStorage.setItem("token",c),localStorage.setItem("userId",a.loginResult.userId),localStorage.setItem("name",a.loginResult.name),window.location.hash="#/",Pt(Ot().mark((function t(){var e,n,o;return Ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,!(e=localStorage.getItem("pushSubscription"))){t.next=13;break}if(t.t0=window.NotificationHelper,t.t0){t.next=8;break}return t.next=7,Promise.resolve().then(r.bind(r,17));case 7:t.t0=t.sent.default;case 8:return n=t.t0,o=JSON.parse(e),t.next=12,n.sendSubscriptionToServer(o,c);case 12:console.log("Synced push subscription after login");case 13:t.next=18;break;case 15:t.prev=15,t.t1=t.catch(0),console.error("Error syncing push subscription:",t.t1);case 18:case"end":return t.stop()}}),t,null,[[0,15]])})))(),Pt(Ot().mark((function t(){var e,n;return Ot().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,t.t0=window.HeaderNotification,t.t0){t.next=6;break}return t.next=5,Promise.resolve().then(r.bind(r,895));case 5:t.t0=t.sent.default;case 6:return t.t0.success("Selamat Datang!","Halo ".concat(a.loginResult.name,", selamat datang di Story Map!"),4e3),t.next=10,new Promise((function(t){return setTimeout(t,500)}));case 10:return t.next=12,Promise.resolve().then(r.bind(r,17));case 12:return e=t.sent,n=e.default,t.next=16,n.showLocalNotification("Selamat Datang!",{body:"Halo ".concat(a.loginResult.name,", selamat datang di Story Map!"),tag:"login-success"});case 16:t.next=21;break;case 18:t.prev=18,t.t1=t.catch(0),console.error("Error showing welcome notification:",t.t1);case 21:case"end":return t.stop()}}),t,null,[[0,18]])})))(),t.next=21;break;case 16:t.prev=16,t.t0=t.catch(1),n.textContent=t.t0.message||"Login failed. Please try again.",n.style.display="block",Pt(Ot().mark((function e(){return Ot().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(e.prev=0,e.t0=window.HeaderNotification,e.t0){e.next=6;break}return e.next=5,Promise.resolve().then(r.bind(r,895));case 5:e.t0=e.sent.default;case 6:e.t0.error("Login Gagal",t.t0.message||"Login failed. Please try again.",5e3),e.next=13;break;case 10:e.prev=10,e.t1=e.catch(0),console.error("Error showing error notification:",e.t1);case 13:case"end":return e.stop()}}),e,null,[[0,10]])})))();case 21:case"end":return t.stop()}}),t,null,[[1,16]])})));return function(e){return t.apply(this,arguments)}}());case 5:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})}],e&&_t(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,n,o}();function It(t){return It="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},It(t)}function At(){At=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),c=new N(n||[]);return o(a,"_invoke",{value:O(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function g(){}function m(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(T([])));k&&k!==r&&n.call(k,a)&&(w=k);var E=b.prototype=g.prototype=Object.create(w);function S(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function r(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==It(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function O(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=j(c,n);if(s){if(s===y)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?v:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=v,n.method="throw",n.arg=u.arg)}}}function j(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,j(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function N(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(It(e)+" is not iterable")}return m.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:m,configurable:!0}),m.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(L.prototype),u(L.prototype,c,(function(){return this})),e.AsyncIterator=L,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new L(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},S(E),u(E,s,"Generator"),u(E,a,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function Ft(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function Gt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Ft(i,n,o,a,c,"next",t)}function c(t){Ft(i,n,o,a,c,"throw",t)}a(void 0)}))}}function Mt(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Dt(n.key),n)}}function Dt(t){var e=function(t){if("object"!=It(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=It(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==It(e)?e:e+""}var Ct=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"render",value:(n=Gt(At().mark((function t(){return At().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.abrupt("return",'\n      <section class="container register-page">\n        <div class="auth-container">\n          <h1>Register</h1>\n          <form id="register-form" class="auth-form">\n            <div class="form-group">\n              <label for="name">Full Name</label>\n              <input \n                type="text" \n                id="name" \n                name="name" \n                required \n                aria-required="true"\n                placeholder="Enter your full name">\n            </div>\n\n            <div class="form-group">\n              <label for="email">Email</label>\n              <input \n                type="email" \n                id="email" \n                name="email" \n                required \n                aria-required="true"\n                placeholder="Enter your email">\n            </div>\n\n            <div class="form-group">\n              <label for="password">Password</label>\n              <input \n                type="password" \n                id="password" \n                name="password" \n                required \n                aria-required="true"\n                placeholder="Enter your password (min. 6 characters)"\n                minlength="6">\n            </div>\n\n            <div class="error-message" id="error-message" role="alert" aria-live="polite"></div>\n\n            <button type="submit" class="submit-button" aria-label="Submit registration form">Register</button>\n          </form>\n\n          <p class="auth-link">\n            Already have an account? <button type="button" id="login-link" class="link-button">Login here</button>\n          </p>\n        </div>\n      </section>\n    ');case 1:case"end":return t.stop()}}),t)}))),function(){return n.apply(this,arguments)})},{key:"afterRender",value:(r=Gt(At().mark((function t(){var e,r;return At().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e=document.getElementById("register-form"),r=document.getElementById("error-message"),document.getElementById("login-link").addEventListener("click",(function(){window.location.hash="#/login"})),e.addEventListener("submit",function(){var t=Gt(At().mark((function t(e){var n,o,i;return At().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return e.preventDefault(),t.prev=1,n=document.getElementById("name").value,o=document.getElementById("email").value,i=document.getElementById("password").value,t.next=7,G.register(n,o,i);case 7:alert("Registration successful! Please login."),window.location.hash="#/login",t.next=15;break;case 11:t.prev=11,t.t0=t.catch(1),r.textContent=t.t0.message||"Registration failed. Please try again.",r.style.display="block";case 15:case"end":return t.stop()}}),t,null,[[1,11]])})));return function(e){return t.apply(this,arguments)}}());case 5:case"end":return t.stop()}}),t)}))),function(){return r.apply(this,arguments)})}],e&&Mt(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r,n}();const Bt={"/":new rt,"/about":new ut,"/add":new St,"/login":new Tt,"/register":new Ct};function qt(t){return qt="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},qt(t)}function zt(){zt=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),c=new N(n||[]);return o(a,"_invoke",{value:O(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function g(){}function m(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(T([])));k&&k!==r&&n.call(k,a)&&(w=k);var E=b.prototype=g.prototype=Object.create(w);function S(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function r(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==qt(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function O(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=j(c,n);if(s){if(s===y)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?v:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=v,n.method="throw",n.arg=u.arg)}}}function j(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,j(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function N(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(qt(e)+" is not iterable")}return m.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:m,configurable:!0}),m.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(L.prototype),u(L.prototype,c,(function(){return this})),e.AsyncIterator=L,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new L(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},S(E),u(E,s,"Generator"),u(E,a,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function Wt(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function Rt(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){Wt(i,n,o,a,c,"next",t)}function c(t){Wt(i,n,o,a,c,"throw",t)}a(void 0)}))}}function Ut(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,Ht(n.key),n)}}function Ht(t){var e=function(t){if("object"!=qt(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=qt(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==qt(e)?e:e+""}function Yt(t,e,r){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,r)}function Qt(t,e){return t.get(Vt(t,e))}function Jt(t,e,r){return t.set(Vt(t,e),r),r}function Vt(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}var Kt=new WeakMap,Xt=new WeakMap,Zt=new WeakMap;const $t=function(){return t=function t(e){var r=e.navigationDrawer,n=e.drawerButton,o=e.content;!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),Yt(this,Kt,null),Yt(this,Xt,null),Yt(this,Zt,null),Jt(Kt,this,o),Jt(Xt,this,n),Jt(Zt,this,r),this._setupDrawer()},e=[{key:"_setupDrawer",value:function(){var t=this;Qt(Xt,this).addEventListener("click",(function(){var e=Qt(Zt,t).classList.toggle("open");Qt(Xt,t).setAttribute("aria-expanded",e.toString())})),document.addEventListener("keydown",(function(e){"Escape"===e.key&&Qt(Zt,t).classList.contains("open")&&(Qt(Zt,t).classList.remove("open"),Qt(Xt,t).setAttribute("aria-expanded","false"))})),document.body.addEventListener("click",(function(e){Qt(Zt,t).contains(e.target)||Qt(Xt,t).contains(e.target)||(Qt(Zt,t).classList.remove("open"),Qt(Xt,t).setAttribute("aria-expanded","false")),Qt(Zt,t).querySelectorAll("a").forEach((function(r){r.contains(e.target)&&(Qt(Zt,t).classList.remove("open"),Qt(Xt,t).setAttribute("aria-expanded","false"))}))})),this._setupKeyboardNavigation()}},{key:"_setupKeyboardNavigation",value:function(){document.addEventListener("keydown",(function(t){"Enter"!==t.key&&" "!==t.key||"BUTTON"!==t.target.tagName&&"A"!==t.target.tagName||(t.preventDefault(),t.target.click())}))}},{key:"renderPage",value:(r=Rt(zt().mark((function t(){var e,r=this;return zt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(i=location.hash.replace("#","")||"/",a=void 0,a=i.split("/"),n={resource:a[1]||null,id:a[2]||null},o=void 0,o="",n.resource&&(o=o.concat("/".concat(n.resource))),n.id&&(o=o.concat("/:id")),e=Bt[o||"/"]){t.next=5;break}return"#/login"!==window.location.hash&&(window.location.hash="#/login"),t.abrupt("return");case 5:if(!document.startViewTransition){t.next=9;break}document.startViewTransition(Rt(zt().mark((function t(){return zt().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:return t.prev=0,t.next=3,e.render();case 3:return Qt(Kt,r).innerHTML=t.sent,t.next=6,e.afterRender();case 6:t.next=11;break;case 8:t.prev=8,t.t0=t.catch(0),console.error("Error rendering page:",t.t0);case 11:case"end":return t.stop()}}),t,null,[[0,8]])})))),t.next=27;break;case 9:return t.prev=9,Qt(Kt,this).classList.add("page-exit"),t.next=13,new Promise((function(t){return setTimeout(t,300)}));case 13:return t.next=15,e.render();case 15:return Qt(Kt,this).innerHTML=t.sent,Qt(Kt,this).classList.remove("page-exit"),Qt(Kt,this).classList.add("page-enter"),t.next=20,e.afterRender();case 20:setTimeout((function(){Qt(Kt,r).classList.remove("page-enter")}),300),t.next=27;break;case 23:t.prev=23,t.t0=t.catch(9),console.error("Error rendering page:",t.t0),Qt(Kt,this).classList.remove("page-exit","page-enter");case 27:case"end":return t.stop()}var n,o,i,a}),t,this,[[9,23]])}))),function(){return r.apply(this,arguments)})}],e&&Ut(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e,r}();var te=r(17),ee=r(895);function re(t){return re="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},re(t)}function ne(){ne=function(){return e};var t,e={},r=Object.prototype,n=r.hasOwnProperty,o=Object.defineProperty||function(t,e,r){t[e]=r.value},i="function"==typeof Symbol?Symbol:{},a=i.iterator||"@@iterator",c=i.asyncIterator||"@@asyncIterator",s=i.toStringTag||"@@toStringTag";function u(t,e,r){return Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}),t[e]}try{u({},"")}catch(t){u=function(t,e,r){return t[e]=r}}function l(t,e,r,n){var i=e&&e.prototype instanceof g?e:g,a=Object.create(i.prototype),c=new N(n||[]);return o(a,"_invoke",{value:O(t,r,c)}),a}function f(t,e,r){try{return{type:"normal",arg:t.call(e,r)}}catch(t){return{type:"throw",arg:t}}}e.wrap=l;var h="suspendedStart",p="suspendedYield",d="executing",v="completed",y={};function g(){}function m(){}function b(){}var w={};u(w,a,(function(){return this}));var x=Object.getPrototypeOf,k=x&&x(x(T([])));k&&k!==r&&n.call(k,a)&&(w=k);var E=b.prototype=g.prototype=Object.create(w);function S(t){["next","throw","return"].forEach((function(e){u(t,e,(function(t){return this._invoke(e,t)}))}))}function L(t,e){function r(o,i,a,c){var s=f(t[o],t,i);if("throw"!==s.type){var u=s.arg,l=u.value;return l&&"object"==re(l)&&n.call(l,"__await")?e.resolve(l.__await).then((function(t){r("next",t,a,c)}),(function(t){r("throw",t,a,c)})):e.resolve(l).then((function(t){u.value=t,a(u)}),(function(t){return r("throw",t,a,c)}))}c(s.arg)}var i;o(this,"_invoke",{value:function(t,n){function o(){return new e((function(e,o){r(t,n,e,o)}))}return i=i?i.then(o,o):o()}})}function O(e,r,n){var o=h;return function(i,a){if(o===d)throw Error("Generator is already running");if(o===v){if("throw"===i)throw a;return{value:t,done:!0}}for(n.method=i,n.arg=a;;){var c=n.delegate;if(c){var s=j(c,n);if(s){if(s===y)continue;return s}}if("next"===n.method)n.sent=n._sent=n.arg;else if("throw"===n.method){if(o===h)throw o=v,n.arg;n.dispatchException(n.arg)}else"return"===n.method&&n.abrupt("return",n.arg);o=d;var u=f(e,r,n);if("normal"===u.type){if(o=n.done?v:p,u.arg===y)continue;return{value:u.arg,done:n.done}}"throw"===u.type&&(o=v,n.method="throw",n.arg=u.arg)}}}function j(e,r){var n=r.method,o=e.iterator[n];if(o===t)return r.delegate=null,"throw"===n&&e.iterator.return&&(r.method="return",r.arg=t,j(e,r),"throw"===r.method)||"return"!==n&&(r.method="throw",r.arg=new TypeError("The iterator does not provide a '"+n+"' method")),y;var i=f(o,e.iterator,r.arg);if("throw"===i.type)return r.method="throw",r.arg=i.arg,r.delegate=null,y;var a=i.arg;return a?a.done?(r[e.resultName]=a.value,r.next=e.nextLoc,"return"!==r.method&&(r.method="next",r.arg=t),r.delegate=null,y):a:(r.method="throw",r.arg=new TypeError("iterator result is not an object"),r.delegate=null,y)}function P(t){var e={tryLoc:t[0]};1 in t&&(e.catchLoc=t[1]),2 in t&&(e.finallyLoc=t[2],e.afterLoc=t[3]),this.tryEntries.push(e)}function _(t){var e=t.completion||{};e.type="normal",delete e.arg,t.completion=e}function N(t){this.tryEntries=[{tryLoc:"root"}],t.forEach(P,this),this.reset(!0)}function T(e){if(e||""===e){var r=e[a];if(r)return r.call(e);if("function"==typeof e.next)return e;if(!isNaN(e.length)){var o=-1,i=function r(){for(;++o<e.length;)if(n.call(e,o))return r.value=e[o],r.done=!1,r;return r.value=t,r.done=!0,r};return i.next=i}}throw new TypeError(re(e)+" is not iterable")}return m.prototype=b,o(E,"constructor",{value:b,configurable:!0}),o(b,"constructor",{value:m,configurable:!0}),m.displayName=u(b,s,"GeneratorFunction"),e.isGeneratorFunction=function(t){var e="function"==typeof t&&t.constructor;return!!e&&(e===m||"GeneratorFunction"===(e.displayName||e.name))},e.mark=function(t){return Object.setPrototypeOf?Object.setPrototypeOf(t,b):(t.__proto__=b,u(t,s,"GeneratorFunction")),t.prototype=Object.create(E),t},e.awrap=function(t){return{__await:t}},S(L.prototype),u(L.prototype,c,(function(){return this})),e.AsyncIterator=L,e.async=function(t,r,n,o,i){void 0===i&&(i=Promise);var a=new L(l(t,r,n,o),i);return e.isGeneratorFunction(r)?a:a.next().then((function(t){return t.done?t.value:a.next()}))},S(E),u(E,s,"Generator"),u(E,a,(function(){return this})),u(E,"toString",(function(){return"[object Generator]"})),e.keys=function(t){var e=Object(t),r=[];for(var n in e)r.push(n);return r.reverse(),function t(){for(;r.length;){var n=r.pop();if(n in e)return t.value=n,t.done=!1,t}return t.done=!0,t}},e.values=T,N.prototype={constructor:N,reset:function(e){if(this.prev=0,this.next=0,this.sent=this._sent=t,this.done=!1,this.delegate=null,this.method="next",this.arg=t,this.tryEntries.forEach(_),!e)for(var r in this)"t"===r.charAt(0)&&n.call(this,r)&&!isNaN(+r.slice(1))&&(this[r]=t)},stop:function(){this.done=!0;var t=this.tryEntries[0].completion;if("throw"===t.type)throw t.arg;return this.rval},dispatchException:function(e){if(this.done)throw e;var r=this;function o(n,o){return c.type="throw",c.arg=e,r.next=n,o&&(r.method="next",r.arg=t),!!o}for(var i=this.tryEntries.length-1;i>=0;--i){var a=this.tryEntries[i],c=a.completion;if("root"===a.tryLoc)return o("end");if(a.tryLoc<=this.prev){var s=n.call(a,"catchLoc"),u=n.call(a,"finallyLoc");if(s&&u){if(this.prev<a.catchLoc)return o(a.catchLoc,!0);if(this.prev<a.finallyLoc)return o(a.finallyLoc)}else if(s){if(this.prev<a.catchLoc)return o(a.catchLoc,!0)}else{if(!u)throw Error("try statement without catch or finally");if(this.prev<a.finallyLoc)return o(a.finallyLoc)}}}},abrupt:function(t,e){for(var r=this.tryEntries.length-1;r>=0;--r){var o=this.tryEntries[r];if(o.tryLoc<=this.prev&&n.call(o,"finallyLoc")&&this.prev<o.finallyLoc){var i=o;break}}i&&("break"===t||"continue"===t)&&i.tryLoc<=e&&e<=i.finallyLoc&&(i=null);var a=i?i.completion:{};return a.type=t,a.arg=e,i?(this.method="next",this.next=i.finallyLoc,y):this.complete(a)},complete:function(t,e){if("throw"===t.type)throw t.arg;return"break"===t.type||"continue"===t.type?this.next=t.arg:"return"===t.type?(this.rval=this.arg=t.arg,this.method="return",this.next="end"):"normal"===t.type&&e&&(this.next=e),y},finish:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.finallyLoc===t)return this.complete(r.completion,r.afterLoc),_(r),y}},catch:function(t){for(var e=this.tryEntries.length-1;e>=0;--e){var r=this.tryEntries[e];if(r.tryLoc===t){var n=r.completion;if("throw"===n.type){var o=n.arg;_(r)}return o}}throw Error("illegal catch attempt")},delegateYield:function(e,r,n){return this.delegate={iterator:T(e),resultName:r,nextLoc:n},"next"===this.method&&(this.arg=t),y}},e}function oe(t,e,r,n,o,i,a){try{var c=t[i](a),s=c.value}catch(t){return void r(t)}c.done?e(s):Promise.resolve(s).then(n,o)}function ie(t){return function(){var e=this,r=arguments;return new Promise((function(n,o){var i=t.apply(e,r);function a(t){oe(i,n,o,a,c,"next",t)}function c(t){oe(i,n,o,a,c,"throw",t)}a(void 0)}))}}window.NotificationHelper=te.default,window.HeaderNotification=ee.default,window.CONFIG={BASE_URL:"https://story-api.dicoding.dev/v1",VAPID_PUBLIC_KEY:"BEl62iUYgUivxIkv69yViEuiBIa40HI8vF8j1uN-pVK0XK6Nbs65lmwMlXHJXqK8v8QJZ1XDSgO8tSCziWbXoFE"},console.log(" Modules exposed to window:",{NotificationHelper:!!window.NotificationHelper,HeaderNotification:!!window.HeaderNotification,CONFIG:!!window.CONFIG}),document.addEventListener("DOMContentLoaded",ie(ne().mark((function t(){var e,r,n;return ne().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(t.prev=0,e=new $t({content:document.querySelector("#main-content"),drawerButton:document.querySelector("#drawer-button"),navigationDrawer:document.querySelector("#navigation-drawer")})){t.next=5;break}return console.error("Failed to initialize app"),t.abrupt("return");case 5:return t.next=7,e.renderPage();case 7:r=!1,window.addEventListener("hashchange",ie(ne().mark((function t(){return ne().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:if(!r){t.next=3;break}return console.log("Already rendering, skipping..."),t.abrupt("return");case 3:return t.prev=3,r=!0,t.next=7,e.renderPage();case 7:t.next=12;break;case 9:t.prev=9,t.t0=t.catch(3),console.error("Error rendering page on hashchange:",t.t0);case 12:return t.prev=12,r=!1,t.finish(12);case 15:case"end":return t.stop()}}),t,null,[[3,9,12,15]])})))),t.next=16;break;case 11:t.prev=11,t.t0=t.catch(0),console.error("Error initializing app:",t.t0),(n=document.querySelector("#main-content"))&&(n.innerHTML='<div class="container"><p role="alert">Error loading application. Please refresh the page.</p></div>');case 16:case"end":return t.stop()}}),t,null,[[0,11]])}))))},895:(t,e,r)=>{function n(t){return n="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},n(t)}function o(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,a(n.key),n)}}function i(t,e,r){return(e=a(e))in t?Object.defineProperty(t,e,{value:r,enumerable:!0,configurable:!0,writable:!0}):t[e]=r,t}function a(t){var e=function(t){if("object"!=n(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=n(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==n(e)?e:e+""}r.r(e),r.d(e,{default:()=>s});var c=function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t)},e=[{key:"init",value:function(){return this.container=document.getElementById("header-notification-container"),!!this.container||(console.warn("Header notification container not found"),!1)}},{key:"show",value:function(t,e){var r=this,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:"info",o=arguments.length>3&&void 0!==arguments[3]?arguments[3]:5e3;if(!this.container&&!this.init())return console.error("Cannot show notification: container not initialized"),null;var i=++this.notificationIdCounter,a=this.createNotificationElement(i,t,e,n);return this.container.appendChild(a),this.notifications.set(i,a),o>0&&setTimeout((function(){r.remove(i)}),o),i}},{key:"getNotificationIcon",value:function(t){var e={success:'<svg class="notification-icon-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <circle cx="12" cy="12" r="10" fill="#10b981" opacity="0.1"/>\n        <path d="M9 12l2 2 4-4" stroke="#10b981" stroke-width="2.5" stroke-linecap="round" stroke-linejoin="round"/>\n        <circle cx="12" cy="12" r="9" stroke="#10b981" stroke-width="2"/>\n      </svg>',error:'<svg class="notification-icon-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <circle cx="12" cy="12" r="10" fill="#ef4444" opacity="0.1"/>\n        <path d="M12 8v4" stroke="#ef4444" stroke-width="2.5" stroke-linecap="round"/>\n        <path d="M12 16h.01" stroke="#ef4444" stroke-width="2.5" stroke-linecap="round"/>\n        <circle cx="12" cy="12" r="9" stroke="#ef4444" stroke-width="2"/>\n      </svg>',warning:'<svg class="notification-icon-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <path d="M12 8v4" stroke="#f59e0b" stroke-width="2.5" stroke-linecap="round"/>\n        <path d="M12 16h.01" stroke="#f59e0b" stroke-width="2.5" stroke-linecap="round"/>\n        <path d="M12 2L2 22h20L12 2z" fill="#f59e0b" opacity="0.1"/>\n        <path d="M12 2L2 22h20L12 2z" stroke="#f59e0b" stroke-width="2" stroke-linejoin="round"/>\n      </svg>',info:'<svg class="notification-icon-svg" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">\n        <circle cx="12" cy="12" r="10" fill="#3b82f6" opacity="0.1"/>\n        <path d="M12 16v-4" stroke="#3b82f6" stroke-width="2.5" stroke-linecap="round"/>\n        <path d="M12 8h.01" stroke="#3b82f6" stroke-width="2.5" stroke-linecap="round"/>\n        <circle cx="12" cy="12" r="9" stroke="#3b82f6" stroke-width="2"/>\n      </svg>'};return e[t]||e.info}},{key:"createNotificationElement",value:function(t,e,r,n){var o=this,i=document.createElement("div");i.className="header-notification ".concat(n),i.setAttribute("role","alert"),i.setAttribute("data-notification-id",t);var a=this.getNotificationIcon(n);return i.innerHTML='\n      <span class="header-notification-icon">'.concat(a,'</span>\n      <div class="header-notification-content">\n        <div class="header-notification-title">').concat(this.escapeHtml(e),"</div>\n        ").concat(r?'<div class="header-notification-message">'.concat(this.escapeHtml(r),"</div>"):"",'\n      </div>\n      <button class="header-notification-close" aria-label="Close notification" data-close-id="').concat(t,'">\n        <svg viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg" width="20" height="20">\n          <path d="M18 6L6 18M6 6l12 12" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>\n        </svg>\n      </button>\n    '),i.querySelector(".header-notification-close").addEventListener("click",(function(){o.remove(t)})),i}},{key:"remove",value:function(t){var e=this,r=this.notifications.get(t);r&&(r.classList.add("hiding"),setTimeout((function(){r.parentNode&&r.parentNode.removeChild(r),e.notifications.delete(t)}),300))}},{key:"clear",value:function(){var t=this;this.notifications.forEach((function(e,r){t.remove(r)}))}},{key:"success",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3;return this.show(t,e,"success",r)}},{key:"error",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:7e3;return this.show(t,e,"error",r)}},{key:"warning",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:6e3;return this.show(t,e,"warning",r)}},{key:"info",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:5e3;return this.show(t,e,"info",r)}},{key:"escapeHtml",value:function(t){var e=document.createElement("div");return e.textContent=t,e.innerHTML}}],null&&o(t.prototype,null),e&&o(t,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}();i(c,"container",null),i(c,"notifications",new Map),i(c,"notificationIdCounter",0),"loading"===document.readyState?document.addEventListener("DOMContentLoaded",(function(){c.init()})):c.init();const s=c},903:(t,e,r)=>{r.r(e),r.d(e,{default:()=>y});var n=r(481),o=r.n(n);function i(t){return i="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t},i(t)}function a(t,e){for(var r=0;r<e.length;r++){var n=e[r];n.enumerable=n.enumerable||!1,n.configurable=!0,"value"in n&&(n.writable=!0),Object.defineProperty(t,c(n.key),n)}}function c(t){var e=function(t){if("object"!=i(t)||!t)return t;var e=t[Symbol.toPrimitive];if(void 0!==e){var r=e.call(t,"string");if("object"!=i(r))return r;throw new TypeError("@@toPrimitive must return a primitive value.")}return String(t)}(t);return"symbol"==i(e)?e:e+""}function s(t,e,r){(function(t,e){if(e.has(t))throw new TypeError("Cannot initialize the same private elements twice on an object")})(t,e),e.set(t,r)}function u(t,e,r){return t.set(f(t,e),r),r}function l(t,e){return t.get(f(t,e))}function f(t,e,r){if("function"==typeof t?t===e:t.has(e))return arguments.length<3?e:r;throw new TypeError("Private element is not present on this object")}r(824);var h=new WeakMap,p=new WeakMap,d=new WeakMap,v=new WeakMap;const y=new(function(){return t=function t(){!function(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}(this,t),s(this,h,null),s(this,p,[]),s(this,d,[-6.2088,106.8456]),s(this,v,13),delete o().Icon.Default.prototype._getIconUrl,o().Icon.Default.mergeOptions({iconRetinaUrl:r(272),iconUrl:r(927),shadowUrl:r(980)})},e=[{key:"initializeMap",value:function(t){var e=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},r=e.center,n=void 0===r?l(d,this):r,i=e.zoom,a=void 0===i?l(v,this):i;u(h,this,o().map(t).setView(n,a)),o().tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors"}).addTo(l(h,this)),o().tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:"Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community"});var c={"Street View":o().tileLayer("https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png",{attribution:"&copy; OpenStreetMap contributors"}),"Satellite View":o().tileLayer("https://server.arcgisonline.com/ArcGIS/rest/services/World_Imagery/MapServer/tile/{z}/{y}/{x}",{attribution:"Tiles &copy; Esri &mdash; Source: Esri, i-cubed, USDA, USGS, AEX, GeoEye, Getmapping, Aerogrid, IGN, IGP, UPR-EGP, and the GIS User Community"})};return o().control.layers(c).addTo(l(h,this)),l(h,this)}},{key:"addMarker",value:function(t,e){var r=arguments.length>2&&void 0!==arguments[2]?arguments[2]:{},n=o().marker([t,e],r).addTo(l(h,this));return l(p,this).push(n),n}},{key:"removeMarker",value:function(t){var e=l(p,this).indexOf(t);e>-1&&(l(p,this).splice(e,1),l(h,this).removeLayer(t))}},{key:"clearMarkers",value:function(){var t=this;l(p,this).forEach((function(e){return l(h,t).removeLayer(e)})),u(p,this,[])}},{key:"setView",value:function(t,e,r){l(h,this).setView([t,e],r)}},{key:"on",value:function(t,e){l(h,this).on(t,e)}},{key:"getMap",value:function(){return l(h,this)}}],e&&a(t.prototype,e),Object.defineProperty(t,"prototype",{writable:!1}),t;var t,e}())}},r={};function n(t){var o=r[t];if(void 0!==o)return o.exports;var i=r[t]={id:t,exports:{}};return e[t].call(i.exports,i,i.exports,n),i.exports}n.m=e,t=[],n.O=(e,r,o,i)=>{if(!r){var a=1/0;for(l=0;l<t.length;l++){for(var[r,o,i]=t[l],c=!0,s=0;s<r.length;s++)(!1&i||a>=i)&&Object.keys(n.O).every((t=>n.O[t](r[s])))?r.splice(s--,1):(c=!1,i<a&&(a=i));if(c){t.splice(l--,1);var u=o();void 0!==u&&(e=u)}}return e}i=i||0;for(var l=t.length;l>0&&t[l-1][2]>i;l--)t[l]=t[l-1];t[l]=[r,o,i]},n.n=t=>{var e=t&&t.__esModule?()=>t.default:()=>t;return n.d(e,{a:e}),e},n.d=(t,e)=>{for(var r in e)n.o(e,r)&&!n.o(t,r)&&Object.defineProperty(t,r,{enumerable:!0,get:e[r]})},n.o=(t,e)=>Object.prototype.hasOwnProperty.call(t,e),n.r=t=>{"undefined"!=typeof Symbol&&Symbol.toStringTag&&Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}),Object.defineProperty(t,"__esModule",{value:!0})},n.p="/submitan-pertama-Intermediate/",(()=>{var t={524:0};n.O.j=e=>0===t[e];var e=(e,r)=>{var o,i,[a,c,s]=r,u=0;if(a.some((e=>0!==t[e]))){for(o in c)n.o(c,o)&&(n.m[o]=c[o]);if(s)var l=s(n)}for(e&&e(r);u<a.length;u++)i=a[u],n.o(t,i)&&t[i]&&t[i][0](),t[i]=0;return n.O(l)},r=self.webpackChunksubmitan_pertama_Intermediate=self.webpackChunksubmitan_pertama_Intermediate||[];r.forEach(e.bind(null,0)),r.push=e.bind(null,r.push.bind(r))})(),n.nc=void 0;var o=n.O(void 0,[464],(()=>n(420)));o=n.O(o)})();